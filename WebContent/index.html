<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.min.css" />
		<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
		<script src="http://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.min.js"></script>
		<script src="js/mobiscroll.custom-2.6.2.min.js" type="text/javascript"></script>
        <link rel="stylesheet" type="text/css" href="css/mobiscroll.custom-2.6.2.min.css" /> 
        <link href="css/style.css" rel="stylesheet">
        <script>
            $(document).ready(function() {
            	
                $('#submit').click(function(event) {
                	var mail = $('#email').val(); 
                	if(validateEmail(mail)){
                        $.get('UserServlet',{email:mail},function(responseText) { 
                        	if(typeof(Storage)!=="undefined") {
        			              localStorage.email=mail;
        			        }
                               if(responseText === "exist")
                            	   window.location = 'poll.html';
                               else
                            	   window.location = 'default.html';   
                            });
                	}
                	else {
                		alert("Please enter a valid email.");
                		$('#email').val('');
                	}
                });
            });
            function validateEmail(email) { 
            	var re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
                return re.test(email);
            } 
        </script>
<meta charset="ISO-8859-1">
<title>Flashpoll@Schools</title>
</head>
<body>
<div data-role="page" id="startPage" data-dom-cache=true>
            <div data-role="header">
                <h2>Flashpoll@Schools</h2>
            </div>
            <div data-role="content">
                <div data-role="fieldcontain">
                <label for="email">Please enter your email: </label>
                <input type="email" id="email" required><br>
                </div>
                <div class="button">
                <input type="submit" id="submit" value="Submit">
                </div>
            </div>
</div>

</body>
</html>